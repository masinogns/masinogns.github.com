---
layout: post
title: 내 모델 설계 - 데이터
categories: Machine Learning
tag: ml
---

## 데이터 다루기.
* 1주일 데이터를 하나로 묶는다.
* 그래프를 겹치게 한다.
* 1/n을 취한다.
* 1주일

생각해 볼 문제
윤달의 처리는 대세에 큰 영향을 미칠 것 같지는 않다고 생각한다.
그래서 굳이 윤달의 처지를 할 필요는 없을 것 같긴함.
생각해봐야 할 문제.

비교 rmse는 표준 공식이 있기 때문에 있는 그대로 저장해두는게 좋고
내가 볼 때만 %가 유용하다.
즉, 다른 케이스와의 비교할 때는 원래의 rmse가 필요하다(%가 없는).

## 데이터 테스트 케이스(데이터 전처리 과정)
* 하루 24시간을 시퀀스로 넣는다. 아웃풋은 한 시간의 생산량을 예측한다.(seq_length=24, input_dim = 9)
* 하루 24시간의 데이터들을 평균을 낸 후에 시퀀스로 한 주(seq_lenght=7, input_dim = 7)를 넣는다. 아웃풋은 하루의 생산량을 예측한다.
* 한 주의 데이터들을 평균을 낸 후에 시퀀스로 한 달(seq_length=4)을 넣는다. 아웃풋은 한 주의 생산량을 예측한다.
* 한 달의 데이터들을 평균을 낸 후에 시퀀스로 6개월(seq_length=6)을 넣는다. 아웃풋은 한 달의 생산량을 예측한다.

### 여기서 가장 좋은 RMSE를 하면 된다.

## 학습률이랑 loop 찾기
adam이라는 알고리즘에 학습률을 넣기 때문에 하나를 찾아두면 그냥 그 학습률을 넣으면 될 것 같다.
레이어를 조작하면서 더욱 좋은 rmse를 찾도록 한다.


## 테스트 과정은?
* 가장 낮은 rmse를 갖는 학습률을 찾는다.
* 여러 데이터 케이스에 같은 학습률을 가지고 테스팅을 하고 rmse를 비교한다.
* 그리고 가장 낮은 rmse를 가지고 있는 데이터 케이스를 가지고 레이어를 조작한다.
* 레이어 쌓거나 dropout도 하면서 가장 낮은 rmse를 찾으면 끝.
* rmse는 멈추는거다. 계속 같은 것으로 쭉가고 안떨어지면 거기서 끝.
* rmse가 멈추는 부분에서 이 데이터가 좋은 데이터라는 것을 알 수 있는 반증이다.

## 내꺼랑 현우꺼 비교 생각
rnn은 예측하면서 어떤 행동을 해야할지 예측해서 말해주면 rnn이다. 예측 문제 !! Regression 문제<br>
cnn은 어떤 패턴을 인식해서 무엇인지 말해주는 것. 다음에 뭘 할지 나는 몰라. 인식 문제 !! Classification 문제

#### 시간 정보
1시간 안에 10만장의 프레임이 있다고 생각할 수 있다.
그런데 얼굴을 인식하는 건 cnn으로 10만 장의 프레임을 랜덤하게 섞게되도 얼굴만 인식하는 거고
지금 싸우는 것인지 아닌지 예측하면서 하는건 rnn이기때문에 프레임 간의 시간 정보가 필요하다.

## 모델의 성능을 더 좋게 만들기 위한 몇가지 기법이 있습니다:

* 학습 속도 감소를 스케줄링 하기,Exponential learning rate
* LSTM 레이어 간에 드롭아웃 적용.


## 기타 송현 생각해 볼 문제

Sketch rnn.
Distortion 이미지를 일그러뜨리고 노이즈를 넣게하고 데이터 뻥튀기하는거.
Google cloud platform.
Google inception v3 —> retrain.py
Image learning.
